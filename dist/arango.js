/*Copyright (c) Kaerus 2012 (kaerus.com), Anders Elo <anders @ kaerus com>*/
define("utils",["require"],function(e){function t(){var e=!1,n={},r=0;typeof arguments[r]=="boolean"&&(e=arguments[r++]),typeof arguments[r+1]=="object"&&(n=arguments[r++]);for(var i;i=arguments[r];r++)n=Object.keys(i).reduce(function(n,r){return i.hasOwnProperty(r)&&(typeof i[r]=="object"?e&&(n[r]=t(!0,n[r],i[r])):i[r]&&(n[r]=i[r])),n},n);return n}function n(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}function r(e){if(!(this instanceof r))return new r;Object.defineProperty(this,"_events",{enumerable:!1,value:{}})}function i(e){var t=/^(?:([A-Za-z]+):)(\/{0,3})(?:([^\x00-\x1F\x7F:]+)?:?([^\x00-\x1F\x7F:]*)@)?([0-9.\-A-Za-z]+)(?::(\d+))?(?:\/([^\x00-\x1F\x7F]+))?$/,n=t.exec(e);if(!n)return!1;var r=/^([\w\-]+)?(?:#([\w\-]+))?(?:\:([\w\-]+))?(?:\?(.*))?$/,i=n[7]?r.exec(n[7]):null;return n?{uriparts:n,protocol:n[1],username:n[3],password:n[4],hostname:n[5],port:n[6],path:i?{first:i[1],hash:i[2],base:i[3],query:i[4],string:n[7]}:n[7]}:!1}function s(e){return Object.prototype.toString.call(e)==="[object Array]"}return r.prototype.on=function(e,t){return e in this._events||(this._events[e]=[]),this._events[e].indexOf(t)<0&&this._events[e].push(t),this},r.prototype.hasEvent=function(e){return this._events.hasOwnProperty(e)},r.prototype.off=function(e,t){if(this._events[e])if(!t)delete this._events[e];else{var n=this._events[e].indexOf(t);n>=0&&(this._events[e].splice(n,1),this._events[e].length===0&&delete this._events[e])}return this},r.prototype.emit=function(e){if(!this._events[e])return!1;var t=Array.prototype.slice.call(arguments,1),n,r=[],i=!1;for(var s=0,o=this._events[e].length;s<o;s++){n=this._events[e][s];if(typeof n=="function"){if(n.apply(this,t)===!1){i=!0;break}}else{if(typeof n!="object")throw"No valid event handler found";typeof n.after=="function"&&r.push(n.after)}}return r.forEach(function(e){i||e.apply(this,t)===!1&&(i=!0)}),this},r.prototype.once=function(e,t){var n=this;return this.on(e,function r(){n.off(e,r),t.apply(this,arguments)}),this},r.prototype.after=function(e,t){return e in this._events||(this._events[e]=[]),this._events[e].indexOf({after:t})<0&&this._events[e].push({after:t}),this},{extend:t,inherit:n,Emitter:r,parseUrl:i,isArray:s}}),define("query",["require","./utils"],function(e){var t=e("./utils");return function(e){function n(){function r(n){var i=n||t.struct;return e.filter(function(e){return i[e]?!0:!1}).map(function(e){var t=e.toUpperCase(),n=i[e];switch(t){case"FROM":t="IN";break;case"INCLUDE":t="";break;case"FILTER":n=n.join(" && ");break;case"LET":n=n.join(" LET ");break;default:}if(typeof n=="object"){var s=r(n);return e==="in"?t+" ( "+s+" )":t+" "+s}return t+" "+n}).join(" ")}var e=["for","in","filter","from","include","collect","into","sort","limit","let","return"],t=this;e.forEach(function(e){t[e]=function(){t.struct||(t.struct={});if(!arguments.length)return t.struct[e];var r=Array.prototype.slice.call(arguments);return typeof r[0]=="function"?t.struct[e]=function(e){var t=new n;return e.apply(t),t.struct}(r[0]):e==="filter"||e==="let"?(t.struct[e]||(t.struct[e]=[]),t.struct[e].push(r.join(" "))):t.struct[e]=r.join(" "),t}}),t.toString=r}function r(){function i(i,s){var o={},u=0,a=Array.prototype.slice.call(s);return o.options=r.options,a[u]instanceof n?o.query=a[u++].toString():typeof a[u]=="string"?o.query=a[u++]:o.query=r.string,typeof a[u]=="object"&&(a[u].hasOwnProperty("bindVars")?t.extend(!0,o,a[u++]):o.bindVars=a[u++]),e.cursor[i](o,a[u])}var r=this;n.call(this),r.new=function(){return new n},Object.defineProperty(r,"string",{query:null,get:function(){return r.struct&&(this.query=r.toString(),delete r.struct),this.query},set:function(e){return this.query=e,delete r.struct,this.query}}),r.options={},r.count=function(e){return r.options.count=e>0?!0:!1,r.options.batchSize=e>0?e:undefined,r},r.test=function(){return i("query",arguments)},r.explain=function(){return i("explain",arguments)},r.exec=function(){var t=function(n){var r=n.result;return r.hasMore?r.next=function(){return e.cursor.get(r.id).then(t)}:delete r.next,r};return i("create",arguments).then(t)}}return t.inherit(r,n),new r}}),define("action",["require","./utils"],function(e){var t=e("./utils");return function(e){function r(){this.submit={}}var n=e.request;return r.prototype.define=function(r){function s(){var e=Array.prototype.splice.call(arguments);return r.data&&(e[0]&&typeof e[0]!="function"?t.isArray(e[0])?e[0].concat(r.data):typeof e[0]=="object"&&(e[0]=t.extend(!0,r.data,e[0])):e.unshift(r.data)),e.unshift(r.url.path?r.url.path.string?r.url.path.string:r.url.path:""),e.unshift(i),n.raw.apply(r.context,e).then(r.result,r.error)}if(typeof r!="object")throw new Error("Action object unspecified");if(!r.name)throw new Error("Action name missing");if(!(r.url=t.parseUrl(r.url)))throw new URIError("Action url invalid");if(r.data&&typeof r.data!="object")throw new Error("Invalid action data type");var i={};return i.method=r.method?r.method.toUpperCase():"GET",i.protocol=r.url.protocol?r.url.protocol:e.server.protocol,i.hostname=r.url.hostname?r.url.hostname:e.server.hostname,i.port=r.url.port?parseInt(r.url.port,10):e.server.port,r.options&&t.extend(!0,i,r.options),this.submit[r.name]=s,this},r.prototype.invoke=function(){var e=Array.prototype.slice.call(arguments),t=e.shift();return this.submit[t].apply(null,e)},new r}}),define("ajax",["require","./utils"],function(e){function r(e,t){var n={NOXHR:[1e3,"Ajax is not supported"],REQUEST:[1001,"Operation failed"],UNIMPLEMENTED:[1002,"Not implemented"]};return{name:"Ajax",type:e,code:n[e][0],message:n[e][1]+(t?": "+t:"")}}function c(e,t){n.Emitter.call(this),this.data=[],this.data.size=0,this.on("response",t),this.after("end",function(){e.close()}),this.after("error",function(){e.close()})}function h(t,l){(function(){if(i==="nodejs"){var n=e(t.protocol||"http").request;h=function(e,t){return delete e.protocol,e.timeout&&(n.socket.setTimeout(e.timeout),delete e.timeout),n(e,t)}}})();if(!(this instanceof h))return new h(t,l);var p=this;p._send=[],p.status="",p.xhr=new i,n.Emitter.call(this),t.timeout?(p._timeout=t.timeout,delete t.timeout):p._timeout=5e3,p.timeoutHandler=function(){p.status="TIMEDOUT",p.xhr.abort()},p.response=new c(p,l),p.response.emit("response",p.response),p.xhr.onreadystatechange=function(){switch(p.xhr.readyState){case f:p.xhr.status?(p.response.statusCode=p.xhr.status,p.response.headers||(p.response.headers=p.parseHeaders()),p.xhr.status>399?(p.response.error=!0,p.response.message=p.xhr.statusText):p.response.writeChunk(p.xhr.responseText),p.response.emit("end")):p.response.emit("error",r("REQUEST",p.xhr.statusText||p.status));break;case a:p.response.headers=p.parseHeaders(),p.response.writeChunk(p.xhr.responseText);break;case u:p.emit("ready");break;case o:break;case s:}},p.on("open",p.startTimer),p.on("close",p.clearTimer),p.request(t,l)}var t=typeof window=="object",n=e("./utils"),i=t?function(){var e,t;if(typeof window.XMLHttpRequest!="undefined")return window.XMLHttpRequest;if(typeof window.ActiveXObject!="undefined"){e="ActiveXObject";var n=["Msxml2.XMLHTTP.6.0","Msxml2.XMLHTTP.3.0","Microsoft.XMLHTTP"];for(var i=0,s=n.length;i<s;i++)try{return window.ActiveXObject(n[i])}catch(o){}throw r("NOXHR","XHR ActiveXObject failed")}throw r("NOXHR","XHR support not found")}():"nodejs",s=0,o=1,u=2,a=3,f=4,l=["accept-charset","accept-encoding","access-control-request-headers","access-control-request-method","connection","content-length","cookie","cookie2","content-transfer-encoding","date","expect","host","keep-alive","origin","referer","te","trailer","transfer-encoding","upgrade","user-agent","via"];return n.inherit(c,n.Emitter),c.prototype.write=function(e){this.data.push(e),this.data.size+=e.length,this.emit("data",this.data[this.data.length-1])},c.prototype.writeChunk=function(e){e.length>this.data.size&&this.write(e.slice(this.data.size))},n.inherit(h,n.Emitter),h.prototype.write=function(e){return this._send.push(e),this},h.prototype.end=function(e){e&&this._send.push(e),this.xhr.send(this._send.length>0?this._send.join(""):null)},h.prototype.close=function(){this.emit("close")},h.prototype.parseHeaders=function(){var e={},t,n,r,i=this.xhr.getAllResponseHeaders();return i.split("\n").forEach(function(i){r=i.indexOf(":"),t=i.slice(0,r).replace(/^[\s]+|[\s]+$/g,"").toLowerCase(),n=i.slice(r+1,i.length).replace(/^[\s]+|[\s]+$/g,""),t&&t.length&&(e[t]=n)}),e},h.prototype.request=function(e,n){var r=e.protocol==="file"&&t,i=r?"http://127.0.0.1:8529"+e.path:e.protocol+"://"+e.hostname+":"+e.port+e.path;e.method=e.method?e.method:"GET",e.headers||(e.headers={}),e.headers["content-type"]||(e.headers["content-type"]="application/json"),this.xhr.open(e.method,i,!0),this.emit("open",e.method,i),Object.keys(e.headers).forEach(function(n){n=n.toLowerCase(),(!t||l.indexOf(n)<0)&&this.xhr.setRequestHeader(n,e.headers[n])},this)},h.prototype.startTimer=function(){this.timer=setTimeout(this.timeoutHandler,this._timeout)},h.prototype.clearTimer=function(){clearTimeout(this.timer)},h.prototype.resetTimer=function(){clearTimeout(this.timer),this.startTimer()},{request:h}}),define("promise",["require"],function(e){function r(){if(!(this instanceof r))return new r}if(typeof setImmediate!="function")if(typeof process!="undefined"&&process&&typeof process.nextTick=="function")setImmediate=process.nextTick;else if(typeof MessageChannel!="undefined"){var t=[],n=new MessageChannel;n.port1.onmessage=function(){var e=t.shift();e&&e()},setImmediate=function(e){t.push(e),n.port2.postMessage()}}else setImmediate=setTimeout;return r.prototype.valueOf=function(){return this.resolved},r.prototype.resolve=function(e){if(!this.status)return;var t=this.promise,n=this.status>0?this.onFullfilled:this.onRejected;e||(e=this.pending),delete this.pending;if(n!==undefined){try{this.resolved=n.apply(null,e)}catch(i){t.rejected(i);return}if(this.resolved instanceof r){this.resolved.then(function(){t.fullfilled.apply(t,arguments)},function(){t.rejected.apply(t,arguments)});return}this.resolved===undefined?this.resolved=e:Object.prototype.toString.call(this.resolved)!=="[object Array]"&&(this.resolved=[this.resolved])}else this.resolved=e;this.onFullfilled=this.onRejected=undefined,this.status>0?t.fullfilled.apply(t,this.resolved):t.rejected.apply(t,this.resolved)},r.prototype.then=function(e,t){var n=this;return this.promise=new r,this.onFullfilled===undefined&&typeof e=="function"&&(this.onFullfilled=e),this.onRejected===undefined&&typeof t=="function"&&(this.onRejected=t),this.pending?setImmediate(function(){n.resolve()}):this.status=0,this.promise},r.prototype.fullfilled=function(){var e=this,t=Array.prototype.slice.call(arguments);return this.status===undefined?(this.status=1,this.pending=t):this.status===0&&(this.status=1,setImmediate(function(){e.resolve(t)})),this},r.prototype.rejected=function(){var e=this,t=Array.prototype.slice.call(arguments);return this.status===undefined?(this.status=-1,this.pending=t):this.status===0&&(this.status=-1,setImmediate(function(){e.resolve(t)})),this},r}),define("request",["require","./utils","./ajax","./promise"],function(e){function i(e,t,i){var s=new r,o=n.request(e,function(e){var t={},n;typeof e.data!="object"&&(e.data=[],e.on("data",function(t){e.data.push(t)})),e.on("end",function(){if(e.data.length>0)try{t=JSON.parse(e.data.join(""))}catch(r){t=e.data.join("")}t.error?n={code:t.code,message:t.errorMessage}:e.error&&(n={code:e.statusCode,message:t.message}),n?s.rejected(n):(delete t.error,delete t.code,s.fullfilled(t,e.headers,e.statusCode))})}).on("error",function(e){s.rejected(e)});return t&&o.write(t),o.end(),i?s.then(function(e,t,n){return i(null,e,t,n)},function(e){return i(e.code,e.message)}):s}var t=e("./utils"),n=e("./ajax"),r=e("./promise");return function(e){function n(n,r,s,o){try{s=s&&!s.length?new Buffer(JSON.stringify(s)):s}catch(u){s=JSON.stringify(s)}return n=t.extend(!0,{path:r,headers:{"content-type":"application/json",connection:"keep-alive","content-length":s?s.length:0}},e.server,n),e.auth&&(n.headers.authorization=e.auth),i(n,s,o)}return{post:function(e,t,r){return n({method:"POST"},e,t,r)},get:function(e,t){return n({method:"GET"},e,null,t)},put:function(e,t,r){return n({method:"PUT"},e,t,r)},"delete":function(e,t){return n({method:"DELETE"},e,null,t)},patch:function(e,t,r){return n({method:"PATCH"},e,t,r)},head:function(e,t){return n({method:"HEAD"},e,null,t)},raw:function(e,t,r,i){return n(e,t,r,i)}}}}),define("ext/crypto",["require"],function(e){var t=t||function(e,t){var n={},r=n.lib={},i=r.Base=function(){function e(){}return{extend:function(t){e.prototype=this;var n=new e;return t&&n.mixIn(t),n.$super=this,n},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.$super.extend(this)}}}(),s=r.WordArray=i.extend({init:function(e,n){e=this.words=e||[],this.sigBytes=n!=t?n:4*e.length},toString:function(e){return(e||u).stringify(this)},concat:function(e){var t=this.words,n=e.words,r=this.sigBytes,e=e.sigBytes;this.clamp();if(r%4)for(var i=0;i<e;i++)t[r+i>>>2]|=(n[i>>>2]>>>24-8*(i%4)&255)<<24-8*((r+i)%4);else if(65535<n.length)for(i=0;i<e;i+=4)t[r+i>>>2]=n[i>>>2];else t.push.apply(t,n);return this.sigBytes+=e,this},clamp:function(){var t=this.words,n=this.sigBytes;t[n>>>2]&=4294967295<<32-8*(n%4),t.length=e.ceil(n/4)},clone:function(){var e=i.clone.call(this);return e.words=this.words.slice(0),e},random:function(t){for(var n=[],r=0;r<t;r+=4)n.push(4294967296*e.random()|0);return s.create(n,t)}}),o=n.enc={},u=o.Hex={stringify:function(e){for(var t=e.words,e=e.sigBytes,n=[],r=0;r<e;r++){var i=t[r>>>2]>>>24-8*(r%4)&255;n.push((i>>>4).toString(16)),n.push((i&15).toString(16))}return n.join("")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r+=2)n[r>>>3]|=parseInt(e.substr(r,2),16)<<24-4*(r%8);return s.create(n,t/2)}},a=o.Latin1={stringify:function(e){for(var t=e.words,e=e.sigBytes,n=[],r=0;r<e;r++)n.push(String.fromCharCode(t[r>>>2]>>>24-8*(r%4)&255));return n.join("")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r++)n[r>>>2]|=(e.charCodeAt(r)&255)<<24-8*(r%4);return s.create(n,t)}},f=o.Utf8={stringify:function(e){try{return decodeURIComponent(escape(a.stringify(e)))}catch(t){throw Error("Malformed UTF-8 data")}},parse:function(e){return a.parse(unescape(encodeURIComponent(e)))}},l=r.BufferedBlockAlgorithm=i.extend({reset:function(){this._data=s.create(),this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=f.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var n=this._data,r=n.words,i=n.sigBytes,o=this.blockSize,u=i/(4*o),u=t?e.ceil(u):e.max((u|0)-this._minBufferSize,0),t=u*o,i=e.min(4*t,i);if(t){for(var a=0;a<t;a+=o)this._doProcessBlock(r,a);a=r.splice(0,t),n.sigBytes-=i}return s.create(a,i)},clone:function(){var e=i.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0});r.Hasher=l.extend({init:function(){this.reset()},reset:function(){l.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize(),this._hash},clone:function(){var e=l.clone.call(this);return e._hash=this._hash.clone(),e},blockSize:16,_createHelper:function(e){return function(t,n){return e.create(n).finalize(t)}},_createHmacHelper:function(e){return function(t,n){return c.HMAC.create(e,n).finalize(t)}}});var c=n.algo={};return n}(Math);return function(e){var n=t,r=n.lib,i=r.WordArray,r=r.Hasher,s=n.algo,o=[],u=[];(function(){function t(t){for(var n=e.sqrt(t),r=2;r<=n;r++)if(!(t%r))return!1;return!0}function n(e){return 4294967296*(e-(e|0))|0}for(var r=2,i=0;64>i;)t(r)&&(8>i&&(o[i]=n(e.pow(r,.5))),u[i]=n(e.pow(r,1/3)),i++),r++})();var a=[],s=s.SHA256=r.extend({_doReset:function(){this._hash=i.create(o.slice(0))},_doProcessBlock:function(e,t){for(var n=this._hash.words,r=n[0],i=n[1],s=n[2],o=n[3],f=n[4],l=n[5],c=n[6],h=n[7],p=0;64>p;p++){if(16>p)a[p]=e[t+p]|0;else{var d=a[p-15],v=a[p-2];a[p]=((d<<25|d>>>7)^(d<<14|d>>>18)^d>>>3)+a[p-7]+((v<<15|v>>>17)^(v<<13|v>>>19)^v>>>10)+a[p-16]}d=h+((f<<26|f>>>6)^(f<<21|f>>>11)^(f<<7|f>>>25))+(f&l^~f&c)+u[p]+a[p],v=((r<<30|r>>>2)^(r<<19|r>>>13)^(r<<10|r>>>22))+(r&i^r&s^i&s),h=c,c=l,l=f,f=o+d|0,o=s,s=i,i=r,r=d+v|0}n[0]=n[0]+r|0,n[1]=n[1]+i|0,n[2]=n[2]+s|0,n[3]=n[3]+o|0,n[4]=n[4]+f|0,n[5]=n[5]+l|0,n[6]=n[6]+c|0,n[7]=n[7]+h|0},_doFinalize:function(){var e=this._data,t=e.words,n=8*this._nDataBytes,r=8*e.sigBytes;t[r>>>5]|=128<<24-r%32,t[(r+64>>>9<<4)+15]=n,e.sigBytes=4*t.length,this._process()}});n.SHA256=r._createHelper(s),n.HmacSHA256=r._createHmacHelper(s)}(Math),t}),define("api/collection",["require"],function(e){return function(e){var t=e.request,n="/_api/collection/";return{create:function(){var r=e.name,i={},s,o=0;return typeof arguments[o]=="string"&&(r=arguments[o++]),typeof arguments[o]=="object"&&(i=arguments[o++]),typeof arguments[o]=="function"&&(s=arguments[o++]),i.name||(i.name=r),t.post(n,i,s)},get:function(e,r){return t.get(n+e,r)},"delete":function(e,r){return t.delete(n+e,r)},truncate:function(e,r){return t.put(n+e+"/truncate",null,r)},count:function(e,r){return t.get(n+e+"/count",r)},figures:function(e,r){return t.get(n+e+"/figures",r)},list:function(e){return t.get(n,e)},load:function(e,r){return t.put(n+e+"/load",null,r)},unload:function(e,r){return t.put(n+e+"/unload",null,r)},rename:function(e,r,i){return typeof r=="string"&&(r={name:r}),t.put(n+e+"/rename",r,i)},getProperties:function(e,r){return t.get(n+e+"/properties",r)},setProperties:function(e,r,i){return t.put(n+e+"/properties",r,i)}}}}),define("api/document",["require"],function(e){return function(e){function i(e,n,r,i){var s={};return s[e]=JSON.stringify(r),t.raw({headers:s},n,null,i)}function s(e,n,r,i,s){var o={};return o[e]=JSON.stringify(r),t.raw({method:"PUT",headers:o},n,i,s)}var t=e.request,n="/_api/document/",r="/_api/document?collection=";return{create:function(){var n=e.name,i={},s="",o,u=0;return typeof arguments[u]=="boolean"&&arguments[u++]===!0&&(s="&createCollection=true"),typeof arguments[u]=="string"&&(n=arguments[u++]),typeof arguments[u]=="object"&&(i=arguments[u++]),typeof arguments[u]=="function"&&(o=arguments[u++]),t.post(r+n+s,i,o)},get:function(e,r){return t.get(n+e,r)},getIfNoneMatch:function(e,t,r){return i("If-None-Match",n+e,t,r)},getIfMatch:function(e,t,r){return i("If-Match",n+e,t,r)},put:function(e,r,i){return t.put(n+e,r,i)},putIfNoneMatch:function(e,t,r,i){return s("if-none-match",n+e,t,r,i)},putIfMatch:function(e,t,r,i){return s("if-match",n+e,t,r,i)},head:function(e,r){return t.head(n+e,r)},patch:function(e,r,i){return t.patch(n+e,r,i)},"delete":function(e,r){return t.delete(n+e,r)},list:function(){var n=e.name,i,s=0;return typeof arguments[s]=="string"&&(n=arguments[s++]),typeof arguments[s]=="function"&&(i=arguments[s++]),t.get(r+n,i)},"import":function(){var t=e.name,n={},r="",i,s=0;typeof arguments[s]=="boolean"&&(r="&createCollection=true",s++),typeof arguments[s]=="string"&&(t=arguments[s++]),typeof arguments[s]=="object"&&(n=arguments[s++]),typeof arguments[s]=="function"&&(i=arguments[s++])}}}}),define("api/cursor",["require"],function(e){return function(e){var t=e.request,n="/_api/cursor/";return{get:function(e,r){return t.put(n+e,{},r)},create:function(e,r){return t.post(n,e,r)},query:function(e,n){return t.post("/_api/query",e,n)},explain:function(e,n){return t.post("/_api/explain",e,n)},"delete":function(e,r){return t.delete(n+e,r)}}}}),define("api/simple",["require"],function(e){return function(e){function s(e,t){return typeof t=="object"&&Object.keys(t).forEach(function(n){switch(n){case"from":e.left=t[n],e.closed=!0;break;case"to":e.right=t[n],e.closed=!0;break;default:e[n]=t[n]}r&&!e.skip&&(e.skip=r),i&&!e.limit&&(e.limit=i)}),e}var t=e.request,n="/_api/simple/",r,i;return{list:function(){var r={collection:e.name},i=0,o,u;return typeof arguments[i]=="string"&&(r.collection=arguments[i++]),typeof arguments[i]=="object"&&(o=arguments[i++]),typeof arguments[i]=="function"&&(u=arguments[i++]),t.put(n+"all",s(r,o),u)},example:function(){var r={collection:e.name},i=0,o,u;return typeof arguments[i]=="string"&&(r.collection=arguments[i++]),typeof arguments[i]=="object"&&typeof arguments[i+1]=="object"&&(o=arguments[i++]),typeof arguments[i]=="object"&&(r.example=arguments[i++]),typeof arguments[i]=="function"&&(u=arguments[i++]),t.put(n+"by-example",s(r,o),u)},first:function(){var r={collection:e.name},i=0,s,o;return typeof arguments[i]=="string"&&(r.collection=arguments[i++]),typeof arguments[i]=="object"&&(r.example=arguments[i++]),typeof arguments[i]=="function"&&(o=arguments[i++]),t.put(n+"first-example",r,o)},range:function(){var r={collection:e.name},i=0,o,u;return typeof arguments[i]=="string"&&(r.collection=arguments[i++]),typeof arguments[i]=="object"&&(o=arguments[i++]),typeof arguments[i]=="function"&&(u=arguments[i++]),t.put(n+"range",s(r,o),u)},near:function(){var r={collection:e.name},i=0,o,u;return typeof arguments[i]=="string"&&(r.collection=arguments[i++]),typeof arguments[i]=="object"&&(o=arguments[i++]),typeof arguments[i]=="function"&&(u=arguments[i++]),t.put(n+"near",s(r,o),u)},within:function(){var r={collection:e.name},i=0,o,u;return typeof arguments[i]=="string"&&(r.collection=arguments[i++]),typeof arguments[i]=="object"&&(o=arguments[i++]),typeof arguments[i]=="function"&&(u=arguments[i++]),t.put(n+"within",s(r,o),u)},skip:function(e){r=e},limit:function(e){i=e}}}}),define("api/index",["require"],function(e){return function(e){var t=e.request,n="/_api/index/",r="/_api/index?collection=";return{get:function(e,r){return t.get(n+e,r)},create:function(){var n=e.name,i={},s,o=0;return typeof arguments[o]=="string"&&(n=arguments[o++]),typeof arguments[o]=="object"&&(i=arguments[o++]),typeof arguments[o]=="function"&&(s=arguments[o++]),t.post(r+n,i,s)},"delete":function(e,r){return t.delete(n+e,r)},list:function(){var n=e.name,i,s=0;return arguments.length>0&&(typeof arguments[s]=="string"&&(n=arguments[s++]),typeof arguments[s]=="function"&&(i=arguments[s++])),t.get(r+n,i)}}}}),define("api/admin",["require"],function(e){return function(e){var t=e.request,n="/_admin/";return{status:function(e){return t.get(n+"status",e)},log:function(){var e="",r,i=0;return typeof arguments[i]=="string"&&(severity="?level="+arguments[i++]),typeof arguments[i]=="object"&&Object.keys(arguments[i++]).forEach(function(e){severity+=severity.length?"&":"?",severity+=e+"="+arguments[i][e]}),typeof arguments[i]=="function"&&(r=arguments[i++]),t.get(n+"log"+severity,r)},getConfig:function(e){return t.get(n+"config/configuration",e)},describeConfig:function(e){return t.get(n+"config/description",e)},listUsers:function(e){return t.get(n+"user-manager/users",e)},getUser:function(e,r){return t.get(n+"user-manager/user/"+e,r)},routes:function(e){return t.get(n+"routing/routes",e)},routesReload:function(e){return t.get(n+"routing/reload",e)}}}}),define("api/edge",["require"],function(e){return function(e){function s(e,n,r,i){var s={};return s[e]=JSON.stringify(r),t.raw({headers:s},n,null,i)}function o(e,n,r,i,s){var o={};return o[e]=JSON.stringify(r),t.raw({method:"PUT",headers:o},n,i,s)}var t=e.request,n="/_api/edge/",r="/_api/edge?collection=",i="/_api/edges/";return{get:function(e,r){return t.get(n+e,r)},getIfNoneMatch:function(e,t,r){return s("If-None-Match",n+e,t,r)},getIfMatch:function(e,t,r){return s("If-Match",n+e,t,r)},create:function(){var n,i,s,o={},u,a=0;return typeof arguments[a]=="string"&&(n=arguments[a++]),typeof arguments[a]=="string"&&(i=arguments[a++]),typeof arguments[a]=="string"&&(s=arguments[a++]),typeof arguments[a]=="object"&&(o=arguments[a++]),typeof arguments[a]=="function"&&(u=arguments[a++]),s||(s=i,i=n,n=e.name),t.post(r+n+"&from="+i+"&to="+s,o,u)},put:function(e,r,i){return t.put(n+e,r,i)},putIfNoneMatch:function(e,t,r,i){return o("if-none-match",n+e,t,r,i)},putIfMatch:function(e,t,r,i){return o("if-match",n+e,t,r,i)},head:function(e,r){return t.head(n+e,r)},patch:function(e,r,i){return t.patch(n+e,r,i)},"delete":function(e,r){return t.delete(n+e,r)},list:function(){var n,r,s,o,u=0;arguments.length>0&&(typeof arguments[u]=="string"&&(n=arguments[u++]),typeof arguments[u]=="string"&&(r=arguments[u++]),typeof arguments[u]=="string"&&(s=arguments[u++]),typeof arguments[u]=="function"&&(o=arguments[u++])),s||(s=r||"any",r=n,n=e.name);var a="?vertex="+r+"&direction="+s;return t.get(i+n+a,o)}}}}),define("api/key",["require"],function(e){return function(e){function i(e,n,r,i,s){var o={},u;return r.expires&&(typeof r.expires=="object"?u=r.expires:u=new Date(Date.parse(r.expires,"yyyy-MM-dd HH:MM:SS")),o["x-voc-expires"]=u.toISOString()),r.extended&&(o["x-voc-extended"]=JSON.stringify(r.extended)),t.raw({method:e,headers:o},n,i,s)}var t=e.request,n="/_api/key/",r="/_api/keys/";return{get:function(){var r=e.name,i,s,o=0;return typeof arguments[o+1]=="string"&&(r=arguments[o++]),typeof arguments[o]=="string"&&(i=arguments[o++]),typeof arguments[o]=="function"&&(s=arguments[o++]),t.get(n+r+"/"+i,s)},create:function(){var t=e.name,r,s={},o={},u,a=0;return typeof arguments[a+1]=="string"&&(t=arguments[a++]),typeof arguments[a]=="string"&&(r=arguments[a++]),s=arguments[a++],o=arguments[a++],typeof arguments[a]=="function"&&(u=arguments[a++]),i("POST",n+t+"/"+r,s,o,u)},put:function(){var t=e.name,r,s={},o={},u,a=0;return typeof arguments[a+1]=="string"&&(t=arguments[a++]),typeof arguments[a]=="string"&&(r=arguments[a++]),s=arguments[a++],o=arguments[a++],typeof arguments[a]=="function"&&(u=arguments[a++]),i("PUT",n+t+"/"+r+"?create=1",s,o,u)},list:function(){var n=e.name,i,s,o=0;return typeof arguments[o+1]=="string"&&(n=arguments[o++]),typeof arguments[o]=="string"&&(i=arguments[o++]),typeof arguments[o]=="function"&&(s=arguments[o++]),t.get(r+n+"/"+i,s)},"delete":function(){var r=e.name,i,s,o=0;return typeof arguments[o+1]=="string"&&(r=arguments[o++]),typeof arguments[o]=="string"&&(i=arguments[o++]),typeof arguments[o]=="function"&&(s=arguments[o++]),t.delete(n+r+"/"+i,s)}}}}),define("arango",["require","./utils","./query","./action","./request","./ext/crypto","./api/collection","./api/document","./api/cursor","./api/simple","./api/index","./api/admin","./api/edge","./api/key"],function(e){function s(){if(!(this instanceof s))return new s.apply(null,arguments);this.use.apply(this,arguments),Object.defineProperty(this,"server",{get:function(){return{protocol:this.protocol,hostname:this.hostname,port:this.port}}}),this.request={};var e=r.request(this);for(var t in e)this.request[t]=e[t];for(var n in r.api)this[n]=r.api[n](this);this.query=r.query(this),this.action=r.action(this)}var t=typeof window=="object"&&window.hasOwnProperty("location"),n=t?window.location:!1,r={},i=e("./utils");return r.query=e("./query"),r.action=e("./action"),r.request=e("./request"),r.cryptojs=e("./ext/crypto"),r.api={collection:e("./api/collection"),document:e("./api/document"),cursor:e("./api/cursor"),simple:e("./api/simple"),index:e("./api/index"),admin:e("./api/admin"),edge:e("./api/edge"),key:e("./api/key")},s.prototype.crypto=r.cryptojs,s.prototype.use=function(){for(var e=0,t;t=arguments[e];e++)if(t instanceof s)i.extend(this,t);else if(typeof t=="object")i.extend(!0,this,t);else{if(typeof t!="string")throw new Error("Can not use connection");var r=i.parseUrl(t);r?(i.extend(this,r),r.path!==null&&(this.path=r.path,typeof this.path=="string"?this.name=this.path:typeof this.path=="object"&&(this.name=this.path.first))):this.name=t}return this.protocol=this.protocol||(n?n.protocol.split(":")[0]:"http"),this.hostname=this.hostname||(n?n.hostname:"127.0.0.1"),this.port=parseInt(this.port,10)||(n?n.port:8529),this.name=this.name||"",this.username&&(this.auth="Basic "+this.crypto.enc.Utf8.parse(this.username+":"+this.password).toString(this.crypto.enc.Base64)),this},{Connection:s}});